{% extends "base.html" %}
{% block title %}Logbook{% endblock %}
{% block header %}Digital Logbook{% endblock %}
{% block content %}
<div class="flex flex-wrap gap-4 mb-6">
  <a href="{{ url_for('logbook.import_entries') }}" class="px-4 py-2 bg-[#1E3A8A] text-white rounded-lg hover:bg-[#1e40af]">Import Excel/CSV</a>
  <a href="{{ url_for('logbook.export_entries') }}" class="px-4 py-2 bg-[#1E3A8A] text-white rounded-lg hover:bg-[#1e40af]">Export Excel</a>
  <a href="{{ url_for('logbook.reports') }}" class="px-4 py-2 border border-slate-300 rounded-lg hover:bg-slate-50">Attendance Reports</a>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
  <div class="bg-white rounded-xl border border-slate-200 p-6">
    <h3 class="font-semibold text-slate-800 mb-4">Check In</h3>
    <form method="POST" action="{{ url_for('logbook.check_in') }}" class="space-y-3">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="text" name="visitor_name" placeholder="Visitor Name *" required class="w-full px-4 py-2 border rounded-lg">
      <input type="text" name="purpose" placeholder="Purpose" class="w-full px-4 py-2 border rounded-lg">
      <button type="submit" class="px-6 py-2 bg-[#1E3A8A] text-white rounded-lg hover:bg-[#1e40af]">Check In</button>
    </form>
  </div>
</div>
<div class="bg-white rounded-xl border border-slate-200 overflow-hidden overflow-x-auto">
  <h3 class="px-4 md:px-6 py-4 font-semibold text-slate-800 border-b border-slate-200">Today's Visitors</h3>
  <table class="w-full text-left min-w-[520px]">
    <thead class="bg-slate-50 border-b border-slate-200">
      <tr>
        <th class="px-6 py-4 font-medium text-slate-700">Visitor</th>
        <th class="px-6 py-4 font-medium text-slate-700">Purpose</th>
        <th class="px-6 py-4 font-medium text-slate-700">Time In</th>
        <th class="px-6 py-4 font-medium text-slate-700">Time Out</th>
        <th class="px-6 py-4 font-medium text-slate-700">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for e in entries %}
      <tr class="border-b border-slate-100 hover:bg-slate-50/50">
        <td class="px-6 py-4">{{ e.visitor_name }}</td>
        <td class="px-6 py-4">{{ e.purpose or '-' }}</td>
        <td class="px-6 py-4">{{ e.time_in.strftime('%H:%M') if e.time_in else '-' }}</td>
        <td class="px-6 py-4">{{ e.time_out.strftime('%H:%M') if e.time_out else '-' }}</td>
        <td class="px-6 py-4">
          {% if not e.time_out %}
          <form method="POST" action="{{ url_for('logbook.check_out', eid=e.id) }}" class="inline">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="text-sm px-2 py-1 bg-amber-100 text-amber-800 rounded hover:bg-amber-200">Check Out</button>
          </form>
          {% else %}
          <span class="text-slate-400">-</span>
          {% endif %}
        </td>
      </tr>
      {% else %}
      <tr><td colspan="5" class="px-6 py-12 text-center text-slate-500">No entries today.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
